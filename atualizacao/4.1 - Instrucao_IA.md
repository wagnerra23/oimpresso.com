# Guia de atualização para DaisyUI 5

Este guia detalha os passos para atualizar o sistema baseado em Bootstrap para DaisyUI 5, em um ambiente Laravel 9.52 com Vite, utilizando jQuery, Axios, DevExtreme e Tailwind CSS. O objetivo é garantir compatibilidade, corrigir problemas de layout.

## Contexto

- **Tecnologias**:
  - Laravel 9.52 com Vite
  - DaisyUI 5 para estilização
  - jQuery, Axios, DevExtreme
  - Tailwind CSS como base
- **Objetivos**:
  - Remover Bootstrap e classes obsoletas
  - Garantir compatibilidade com DaisyUI 5
  - Implementar layout padronizado (card com título, filtros, tabelas)
  - Manter  tabelas (DataTables)
    Atualizar modais do bootstrap para DaisyUI.

## Substituições de Classes

### Layout

- `row` → `flex flex-wrap -mx-2`
- `col-md-12` → `w-full px-2`
- `col-md-3` → `w-full md:w-1/4 px-2 mb-4`
- `form-group` → `form-control`
- `table-responsive` → Remover (usar `overflow-x-auto`)

### Botões

- `btn btn-block btn-secondary` → `btn btn-neutral w-full mb-2`
- `btn btn-primary` → `btn btn-primary` (testar hover/tamanhos)

### Abas

- `nav-tabs-custom`, `nav-tabs` → `tabs tabs-boxed`
- `tab-pane active` → `tab-pane block`
- `tab-pane` → `tab-pane hidden`
- Nova classe: `tabs-border` (sublinhado na aba selecionada)

### Modais

- `modal fade` → `modal modal-closed` (ou `<dialog class="modal">`)
- `modal-dialog` → `modal-box`
- `modal-content`, `modal-header` → Remover (usar botão de fechar em `modal-box`)
- Manter `btn-modal` para compatibilidade
- Botão de fechar: `<button class="btn btn-sm btn-circle btn-ghost absolute right-2 top-2 btn-close-modal">✕</button>`

### Inputs

- `style="width:100%"` → `w-full`
- `form-control` → `input input-bordered w-full` (ou `textarea textarea-bordered w-full`)
- Manter `select2` para inicialização via `common.js`

### Checkbox

```html
<label class="label cursor-pointer">
    <span class="label-text">Texto</span>
    <input type="checkbox" class="checkbox">
</label>
```

### Dropdown

- `btn-group`, `dropdown-menu` → `dropdown`, `dropdown-content menu`
- Botão: `btn btn-sm btn-info`
- Menu: `menu p-2 shadow bg-base-100 rounded-box w-52`
- Divisória: `<li class="divider"></li>` → `<li><hr class="divider"></li>`

### Ícones

- Substituir SVG do ícone `+` por `<i class="fas fa-plus"></i>`
- Usar `fas` (Font Awesome) ou ícones DaisyUI (ex.: Heroicons, se necessário)

### Remoções

- `<section class="content-header">` e seus comentários
- `@section('javascript')` (mover para `nometabela.js`)
- `@section('title', ...)`
- Prefixos `tw-dw-` e `tw-` (ex.: `tw-dw-button` → `button`, `tw-text-base` → `text-base`)
- Classes obsoletas: `card-header`, `table-bordered`, `input-bordered`

## Funcionalidades

### Botão de Filtro

Implementar com jQuery para alternar visibilidade dos filtros:

```javascript
$(document).ready(function() {
    $('#filter-btn').on('click', function() {
        $('#filter-section').toggleClass('hidden');
    });
});
```

Estrutura de filtros:

```html
<div id="filter-section" class="hidden flex flex-wrap gap-4">
    <!-- Filtros -->
</div>
```

### Modais

Usar `<dialog>` para modais DaisyUI:

```html
<dialog id="myModal" class="modal">
    <div class="modal-box">
        <form method="dialog">
            <button class="btn btn-sm btn-circle btn-ghost absolute right-2 top-2 btn-close-modal">✕</button>
        </form>
        <!-- Conteúdo -->
    </div>
</dialog>
```

Substituir manipulação Bootstrap:

- `$(modal).modal('show')` → `modal.showModal()`
- `$(modal).modal('hide')` → `modal.close()`

## Configuração do Ambiente

### Dependências

```bash
npm install jquery datatables.net datatables.net-dt select2 pace-js icheck bootstrap-datepicker sweetalert2 dropzone bootstrap-fileinput moment tailwindcss @tailwindcss/forms axios --save
```

### Tailwind CSS

Atualizar `tailwind.config.js`:

```javascript
module.exports = {
    content: [
        './resources/**/*.{php,html,js,vue}',
        './Modules/**/*.{php,html,js,vue}',
    ],
    theme: { extend: {} },
    plugins: [require('@tailwindcss/forms')],
};
```

Atualizar `resources/css/app.css`:

```css
@tailwind base;
@tailwind components;
@tailwind utilities;
@import 'datatables.net-dt/css/jquery.dataTables.css';
@import 'select2/dist/css/select2.css';
@import '_datatables.css';
@import '_select2.css';
```

### Estilização de DataTables (`_datatables.css`)

```css
.dataTables_wrapper {
    @apply bg-white dark:bg-gray-800 rounded-lg shadow p-4;
}
.dataTables_wrapper table {
    @apply min-w-full border border-gray-200 dark:border-gray-700 shadow-sm rounded;
}
.dataTables_wrapper thead th {
    @apply bg-gray-50 dark:bg-gray-700 text-gray-700 dark:text-gray-200 font-semibold py-3 px-4 border-b border-gray-200 dark:border-gray-600 text-left text-sm;
}
.dataTables_wrapper tbody tr {
    @apply hover:bg-gray-50 dark:hover:bg-gray-700;
}
.dataTables_wrapper tbody td {
    @apply py-3 px-4 border-b border-gray-200 dark:border-gray-600 text-gray-900 dark:text-gray-200 text-sm;
}
.dataTables_wrapper .dataTables_paginate .paginate_button {
    @apply px-3 py-1 mx-1 text-gray-700 dark:text-gray-200 hover:bg-blue-500 dark:hover:bg-blue-600 hover:text-white dark:hover:text-white rounded transition-colors text-sm;
}
.dataTables_wrapper .dataTables_paginate .paginate_button.current {
    @apply bg-blue-500 dark:bg-blue-600 text-white rounded text-sm;
}
.dataTables_wrapper .dataTables_filter input {
    @apply w-full max-w-xs text-gray-900 dark:text-gray-200 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500 p-2;
}
```

### Vite

Atualizar `vite.config.js`:

```javascript
import { defineConfig } from 'vite';
import laravel from 'laravel-vite-plugin';

export default defineConfig({
    plugins: [
        laravel({
            input: ['resources/css/app.css', 'resources/js/app.js'],
            refresh: true,
        }),
    ],
    resolve: {
        alias: {
            'jquery': 'jquery/dist/jquery.min.js',
            'datatables.net': 'datatables.net/js/dataTables.js',
            'select2': 'select2/dist/js/select2.full.js',
        },
    },
});
```

## Integração de Modais

### Modal com `modal.js`

Atualizar `modal.js` para usar Axios:

```javascript
import axios from 'axios';

export function showModal(content, onOpen = null, onSubmit = null) {
    const modal = document.createElement('div');
    modal.classList.add('modal', 'modal-open');
    modal.id = 'dynamic-modal';
    modal.innerHTML = `
        <div class="modal-box relative max-w-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-200">
            ${content}
            <button class="btn btn-sm btn-circle btn-ghost absolute right-2 top-2 btn-close-modal">✕</button>
        </div>
    `;

    document.body.appendChild(modal);
    const closeModal = () => {
        modal.classList.remove('modal-open');
        setTimeout(() => modal.remove(), 300);
    };

    modal.querySelector('.btn-close-modal').addEventListener('click', closeModal);
    modal.addEventListener('click', e => {
        if (e.target === modal) closeModal();
    });

    const form = modal.querySelector('form');
    if (form && onSubmit) {
        form.addEventListener('submit', async e => {
            e.preventDefault();
            const formData = new FormData(form);
            try {
                const response = await axios.post(form.action, formData);
                onSubmit(response.data, modal);
                closeModal();
            } catch (error) {
                console.error('Erro ao submeter formulário:', error);
            }
        });
    }

    if (onOpen) onOpen(modal);
    modal.close = closeModal;
    return modal;
}

export async function openAjaxModal(url, onOpen = null, onSubmit = null) {
    try {
        const response = await axios.get(url);
        return showModal(response.data, onOpen, onSubmit);
    } catch (error) {
        console.error('Erro ao carregar modal:', error);
        throw error;
    }
}

document.querySelectorAll('.btn-modal').forEach(button => {
    button.addEventListener('click', e => {
        e.preventDefault();
        const url = button.getAttribute('data-href');
        openAjaxModal(url, modal => {
            modal.querySelectorAll('.select2').forEach(el => $(el).select2());
        }, (data, modal) => {
            if (typeof variation_table !== 'undefined') variation_table.ajax.reload();
        });
    });
});
```

Importar em `app.js`:

```javascript
import { showModal, openAjaxModal } from './modal.js';
```

## Testes e Depuração

1. **Comandos**:
   - Desenvolvimento: `npm run dev`
   - Produção: `npm run build`
2. **Verificações**:
   - Estilos de tabelas, botões, inputs e modais
   - Funcionalidade de formulários, modais e eventos jQuery
   - Console para erros (ex.: `DataTable is not a function`, `axios is not defined`)
3. **Solução de Problemas**:
   - **DataTables sem estilo**: Ajustar `_datatables.css` ou usar `datatables.net-tailwindcss`
   - **Modal não funciona**: Verificar importação de `axios` e URLs em `data-href`
   - **Conflitos de estilo**: Usar `!important` em `_datatables.css`, se necessário

## Exemplo de Formulário (Blade)

```html
{!! Form::open(['url' => '/api/brands', 'method' => 'POST', 'id' => 'brand_create_form']) !!}
    <div class="form-control">
        {!! Form::label('name', __('brand.name') . ':') !!}
        {!! Form::text('name', null, ['class' => 'input input-bordered w-full', 'required']) !!}
    </div>
    <div class="form-control">
        {!! Form::label('description', __('brand.note') . ':') !!}
        {!! Form::textarea('description', null, ['class' => 'textarea textarea-bordered w-full']) !!}
    </div>
    <div class="form-control">
        {!! Form::label('category', 'Categoria:') !!}
        <select name="category" class="select select-bordered w-full select2">
            <option value="1">Categoria 1</option>
            <option value="2">Categoria 2</option>
        </select>
    </div>
    <button type="submit" class="btn btn-primary">Salvar</button>
    <button type="button" class="btn btn-ghost btn-close-modal">Fechar</button>
{!! Form::close() !!}
```

## Estrutura de Layout

Todo conteúdo deve ser encapsulado em um único **card** com a seguinte estrutura:

1. **Primeira Linha**: Ícone, título, subtítulo, botão de ajuda, abas (se aplicável), ferramentas (ex.: "Download Excel", "Adicionar"), botão de filtro e campo de pesquisa.
2. **Divisória**: `<hr class="divider">` entre título e conteúdo.
3. **Segunda Linha**: Filtros exibidos condicionalmente ao clicar no botão de filtro.
4. **Terceira Linha**: Tabela (DataTables) ou conteúdo principal.

### Exemplo de Layout (Blade)

```html
<div class="card bg-base-100 shadow-xl">
    <div class="card-body">
        <!-- Primeira Linha -->
        <div class="flex flex-wrap items-center justify-between gap-4">
            <div class="flex items-center gap-2">
                <i class="fas fa-list"></i>
                <h2 class="card-title">Título</h2>
                <button class="btn btn-ghost btn-sm" title="Ajuda">?</button>
            </div>
            <div class="flex gap-2">
                <button class="btn btn-neutral btn-sm"><i class="fas fa-file-excel"></i> Download Excel</button>
                <button class="btn btn-primary btn-sm"><i class="fas fa-plus"></i> Adicionar</button>
                <button id="filter-btn" class="btn btn-outline btn-sm"><i class="fas fa-filter"></i> Filtros</button>
                <input type="text" placeholder="Pesquisar..." class="input input-bordered w-full max-w-xs">
            </div>
        </div>
        <hr class="divider">
        <!-- Segunda Linha: Filtros -->
        <div id="filter-section" class="hidden flex flex-wrap gap-4">
            <div class="form-control w-full md:w-1/4">
                <label class="label"><span class="label-text">Filtro 1</span></label>
                <input type="text" class="input input-bordered w-full">
            </div>
        </div>
        <!-- Terceira Linha: Tabela -->
        <div class="overflow-x-auto">
            <table id="example-table" class="table w-full">
                <thead>
                    <tr>
                        <th>Nome</th>
                        <th>Ações</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Conteúdo dinâmico -->
                </tbody>
            </table>
        </div>
    </div>
</div>
```

# Migração para Vanilla JS

Vou ajudar a migrar o código jQuery para Vanilla JS, focando especialmente na parte do modal que você mencionou anteriormente. Aqui está a abordagem:

## Modal com DaisyUI + Vanilla JS

```html
<!-- HTML - Mantém a mesma estrutura -->
<button id="view_todays_profit" class="btn btn-primary">Ver Lucro Hoje</button>

<dialog id="todays_profit_modal" class="modal">
  <div class="modal-box">
    <div id="todays_profit"></div>
    <div class="modal-action">
      <form method="dialog">
        <button class="btn">Fechar</button>
      </form>
    </div>
  </div>
</dialog>
```

```javascript
// Vanilla JS equivalente
document.addEventListener('DOMContentLoaded', function() {
  // Elementos
  const viewProfitBtn = document.getElementById('view_todays_profit');
  const profitModal = document.getElementById('todays_profit_modal');
  const todaysProfitContent = document.getElementById('todays_profit');
  
  // Função para mostrar o modal
  function showProfitModal() {
    // Mostrar loader
    todaysProfitContent.innerHTML = '<div class="text-center"><i class="fa fa-sync fa-spin fa-fw"></i></div>';
  
    // Abrir modal
    profitModal.showModal();
  
    // Carregar dados (simulação)
    setTimeout(() => {
      const start = document.getElementById('modal_today').value;
      updateProfitLoss(start, start, '', todaysProfitContent);
    }, 500);
  }
  
  // Event listener
  viewProfitBtn.addEventListener('click', showProfitModal);
  
  // Função de atualização (adaptada)
  function updateProfitLoss(start, end, location_id, targetElement) {
    // Simulação de requisição AJAX
    fetch(`/api/profit-loss?start=${start}&end=${end}&location=${location_id}`)
      .then(response => response.json())
      .then(data => {
        targetElement.innerHTML = `
          <h3 class="font-bold text-lg">Lucro de Hoje</h3>
          <p>${data.profit}</p>
        `;
      })
      .catch(error => {
        targetElement.innerHTML = '<p class="text-error">Erro ao carregar dados</p>';
        console.error('Error:', error);
      });
  }
});
```

## Principais Mudanças:

1. **Seleção de Elementos**:

   - `$('#id')` → `document.getElementById('id')`
2. **Event Listeners**:

   - `$(el).click(fn)` → `el.addEventListener('click', fn)`
3. **Manipulação de DOM**:

   - `$(el).html(content)` → `el.innerHTML = content`
   - `$(el).text(content)` → `el.textContent = content`
4. **AJAX**:

   - `$.ajax()` → `fetch()`
5. **Modais**:

   - `$(modal).modal('show')` → `modal.showModal()`
   - `$(modal).modal('hide')` → `modal.close()`

## Benefícios da Migração:

1. **Performance**: Vanilla JS é mais rápido sem o overhead do jQuery
2. **Tamanho**: Elimina a dependência do jQuery (~80KB)
3. **Modernidade**: Usa APIs nativas do navegador
4. **Manutenção**: Código mais alinhado com padrões modernos

## Desafios:

1. **Cross-browser**: Algumas APIs podem precisar de polyfills
2. **Sintaxe**: Algumas operações são mais verbosas
3. **Plugins**: Substituir funcionalidades de plugins jQuery

## Dicas para Migração Progressiva:

1. Comece por componentes isolados
2. Use a função `document.ready` nativa:

   ```javascript
   document.addEventListener('DOMContentLoaded', function() {
     // Seu código aqui
   });
   ```
3. Para seleção múltipla:

   ```javascript
   // jQuery: $('.class')
   // Vanilla JS:
   document.querySelectorAll('.class').forEach(el => {
     // manipulação
   });
   ```
4. Para eventos delegados:

   ```javascript
   // jQuery: $(parent).on('click', '.child', fn)
   // Vanilla JS:
   parent.addEventListener('click', function(e) {
     if(e.target.matches('.child')) {
       // seu código
     }
   });
   ```


## 



Conclusão

Este guia cobre a migração para DaisyUI 5, incluindo substituição de classes, configuração do ambiente, modularização de scripts e implementação de funcionalidades. Use `modal.js` para consistência com jQuery, evitando Alpine.js. Teste telas (ex.: `/brands/create`, `/note-documents`) para validar estilos e funcionalidades. Para ajustes específicos, contate a equipe de desenvolvimento.
